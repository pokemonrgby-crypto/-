<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>ì¤‘í•™ ìˆ˜í•™ 1000ì œ</title>
    <style>
        :root {
            --bg-primary: #0a0a0f;
            --bg-secondary: #12121a;
            --bg-card: #1a1a25;
            --bg-hover: #22222f;
            --text-primary: #f0f0f5;
            --text-secondary: #9090a0;
            --text-muted: #606070;
            --accent-1: #6366f1;
            --accent-2: #8b5cf6;
            --accent-3: #ec4899;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --border: rgba(255,255,255,0.08);
            --glow: rgba(99,102,241,0.15);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        html { font-size: 16px; scroll-behavior: smooth; }
        body { font-family: 'Malgun Gothic', 'Apple SD Gothic Neo', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: var(--bg-primary); color: var(--text-primary); min-height: 100vh; line-height: 1.7; }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: var(--bg-secondary); }
        ::-webkit-scrollbar-thumb { background: var(--accent-1); border-radius: 3px; }
        
        .header { position: fixed; top: 0; left: 0; right: 0; height: 64px; background: rgba(10,10,15,0.95); backdrop-filter: blur(20px); border-bottom: 1px solid var(--border); z-index: 1000; display: flex; align-items: center; justify-content: space-between; padding: 0 20px; }
        .logo { display: flex; align-items: center; gap: 10px; }
        .logo-icon { width: 36px; height: 36px; background: linear-gradient(135deg, var(--accent-1), var(--accent-2)); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 18px; font-weight: 700; }
        .logo-text { font-weight: 700; font-size: 1.1rem; background: linear-gradient(135deg, var(--text-primary), var(--accent-2)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .header-stats { display: flex; gap: 16px; }
        .stat-item { text-align: center; }
        .stat-value { font-family: monospace; font-size: 1rem; font-weight: 600; color: var(--accent-1); }
        .stat-label { font-size: 0.65rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px; }
        
        .main-content { padding-top: 64px; min-height: 100vh; }
        .grade-tabs { display: flex; justify-content: center; gap: 6px; padding: 16px; background: var(--bg-secondary); border-bottom: 1px solid var(--border); position: sticky; top: 64px; z-index: 100; }
        .grade-tab { padding: 10px 24px; border: none; background: transparent; color: var(--text-secondary); font-family: inherit; font-size: 0.95rem; font-weight: 500; cursor: pointer; border-radius: 10px; transition: all 0.3s; position: relative; }
        .grade-tab:hover { color: var(--text-primary); background: var(--bg-hover); }
        .grade-tab.active { color: white; background: linear-gradient(135deg, var(--accent-1), var(--accent-2)); }
        .grade-tab .badge { position: absolute; top: -4px; right: -4px; background: var(--accent-3); color: white; font-size: 0.6rem; padding: 2px 5px; border-radius: 8px; font-weight: 600; }
        
        .content-area { max-width: 1100px; margin: 0 auto; padding: 24px 16px; }
        .semester-selector { display: flex; justify-content: center; gap: 10px; margin-bottom: 24px; }
        .semester-btn { padding: 8px 20px; border: 1px solid var(--border); background: var(--bg-card); color: var(--text-secondary); font-family: inherit; font-size: 0.85rem; cursor: pointer; border-radius: 8px; transition: all 0.2s; }
        .semester-btn:hover { border-color: var(--accent-1); color: var(--text-primary); }
        .semester-btn.active { background: var(--accent-1); border-color: var(--accent-1); color: white; }
        
        .units-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 16px; }
        .unit-card { background: var(--bg-card); border: 1px solid var(--border); border-radius: 14px; overflow: hidden; transition: all 0.3s; cursor: pointer; }
        .unit-card:hover { transform: translateY(-3px); border-color: var(--accent-1); box-shadow: 0 8px 32px rgba(0,0,0,0.3), 0 0 24px var(--glow); }
        .unit-header { padding: 16px; background: linear-gradient(135deg, rgba(99,102,241,0.1), rgba(139,92,246,0.05)); border-bottom: 1px solid var(--border); }
        .unit-number { font-size: 0.7rem; color: var(--accent-1); font-weight: 600; letter-spacing: 1px; text-transform: uppercase; margin-bottom: 4px; }
        .unit-title { font-size: 1.1rem; font-weight: 700; margin-bottom: 8px; }
        .unit-progress { display: flex; align-items: center; gap: 8px; }
        .progress-bar { flex: 1; height: 4px; background: var(--bg-hover); border-radius: 2px; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, var(--success), var(--accent-1)); border-radius: 2px; transition: width 0.5s; }
        .progress-text { font-family: monospace; font-size: 0.7rem; color: var(--text-muted); }
        .unit-body { padding: 12px 16px; }
        .unit-topics { display: flex; flex-wrap: wrap; gap: 5px; }
        .topic-tag { padding: 3px 8px; background: var(--bg-hover); border-radius: 5px; font-size: 0.75rem; color: var(--text-secondary); }
        
        .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.8); backdrop-filter: blur(8px); z-index: 2000; display: none; }
        .modal-overlay.active { display: block; }
        .modal { position: fixed; inset: 0; background: var(--bg-primary); z-index: 2001; display: none; flex-direction: column; }
        .modal.active { display: flex; }
        .modal-header { display: flex; align-items: center; justify-content: space-between; padding: 14px 16px; background: var(--bg-secondary); border-bottom: 1px solid var(--border); }
        .modal-title { font-size: 1rem; font-weight: 600; }
        .modal-close { width: 36px; height: 36px; border: none; background: var(--bg-hover); color: var(--text-primary); border-radius: 8px; cursor: pointer; font-size: 1.1rem; display: flex; align-items: center; justify-content: center; transition: all 0.2s; }
        .modal-close:hover { background: var(--error); }
        .modal-body { flex: 1; overflow-y: auto; padding: 16px; }
        
        .modal-tabs { display: flex; gap: 4px; background: var(--bg-card); padding: 5px; border-radius: 10px; margin-bottom: 20px; }
        .modal-tab { flex: 1; padding: 10px; border: none; background: transparent; color: var(--text-secondary); font-family: inherit; font-size: 0.85rem; font-weight: 500; cursor: pointer; border-radius: 6px; transition: all 0.2s; }
        .modal-tab:hover { color: var(--text-primary); }
        .modal-tab.active { background: var(--accent-1); color: white; }
        
        .section { display: none; }
        .section.active { display: block; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
        
        .concept-block { background: var(--bg-card); border: 1px solid var(--border); border-radius: 12px; margin-bottom: 12px; overflow: hidden; }
        .concept-header { padding: 14px 16px; background: linear-gradient(135deg, rgba(99,102,241,0.08), transparent); cursor: pointer; display: flex; align-items: center; justify-content: space-between; transition: background 0.2s; }
        .concept-header:hover { background: rgba(99,102,241,0.12); }
        .concept-title { font-weight: 600; display: flex; align-items: center; gap: 8px; }
        .concept-icon { width: 26px; height: 26px; background: var(--accent-1); border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 0.8rem; }
        .concept-toggle { color: var(--text-muted); transition: transform 0.3s; font-size: 0.8rem; }
        .concept-block.open .concept-toggle { transform: rotate(180deg); }
        .concept-content { max-height: 0; overflow: hidden; transition: max-height 0.4s; }
        .concept-block.open .concept-content { max-height: 2000px; }
        .concept-inner { padding: 16px; border-top: 1px solid var(--border); }
        .concept-inner p { margin-bottom: 10px; color: var(--text-secondary); font-size: 0.95rem; }
        .formula-box { background: var(--bg-hover); border-left: 3px solid var(--accent-1); padding: 12px 16px; border-radius: 0 10px 10px 0; margin: 12px 0; font-family: monospace; font-size: 1rem; color: var(--accent-2); white-space: pre-wrap; }
        .example-box { background: rgba(16, 185, 129, 0.1); border: 1px solid rgba(16, 185, 129, 0.2); border-radius: 10px; padding: 12px; margin: 12px 0; }
        .example-label { font-size: 0.7rem; font-weight: 600; color: var(--success); text-transform: uppercase; letter-spacing: 1px; margin-bottom: 6px; }
        
        .problem-filters { display: flex; gap: 6px; margin-bottom: 16px; flex-wrap: wrap; }
        .filter-btn { padding: 6px 14px; border: 1px solid var(--border); background: var(--bg-card); color: var(--text-secondary); font-family: inherit; font-size: 0.8rem; cursor: pointer; border-radius: 16px; transition: all 0.2s; }
        .filter-btn:hover { border-color: var(--accent-1); color: var(--text-primary); }
        .filter-btn.active { background: var(--accent-1); border-color: var(--accent-1); color: white; }
        
        .quick-nav { display: grid; grid-template-columns: repeat(10, 1fr); gap: 4px; margin-bottom: 16px; padding: 12px; background: var(--bg-card); border-radius: 10px; }
        .quick-nav-btn { aspect-ratio: 1; border: 1px solid var(--border); background: var(--bg-hover); color: var(--text-secondary); font-family: monospace; font-size: 0.7rem; cursor: pointer; border-radius: 6px; transition: all 0.2s; }
        .quick-nav-btn:hover { border-color: var(--accent-1); color: var(--text-primary); }
        .quick-nav-btn.current { background: var(--accent-1); border-color: var(--accent-1); color: white; }
        .quick-nav-btn.solved { background: var(--success); border-color: var(--success); color: white; }
        .quick-nav-btn.wrong { background: var(--error); border-color: var(--error); color: white; }
        
        .problem-card { background: var(--bg-card); border: 1px solid var(--border); border-radius: 14px; padding: 20px; margin-bottom: 12px; transition: all 0.3s; }
        .problem-card:hover { border-color: var(--accent-1); }
        .problem-card.solved { border-color: var(--success); background: rgba(16, 185, 129, 0.05); }
        .problem-card.wrong { border-color: var(--error); background: rgba(239, 68, 68, 0.05); }
        .problem-meta { display: flex; align-items: center; gap: 10px; margin-bottom: 14px; }
        .problem-number { font-family: monospace; font-size: 0.75rem; color: var(--text-muted); background: var(--bg-hover); padding: 3px 8px; border-radius: 5px; }
        .problem-difficulty { font-size: 0.7rem; padding: 3px 8px; border-radius: 5px; font-weight: 600; }
        .difficulty-easy { background: rgba(16, 185, 129, 0.2); color: var(--success); }
        .difficulty-medium { background: rgba(245, 158, 11, 0.2); color: var(--warning); }
        .difficulty-hard { background: rgba(239, 68, 68, 0.2); color: var(--error); }
        .problem-text { font-size: 1.05rem; line-height: 1.8; margin-bottom: 16px; white-space: pre-wrap; }
        
        .problem-choices { display: grid; gap: 8px; margin-bottom: 16px; }
        .choice-btn { padding: 12px 16px; border: 1px solid var(--border); background: var(--bg-hover); color: var(--text-primary); font-family: inherit; font-size: 0.95rem; cursor: pointer; border-radius: 10px; text-align: left; transition: all 0.2s; display: flex; align-items: center; gap: 10px; }
        .choice-btn:hover:not(:disabled) { border-color: var(--accent-1); background: rgba(99,102,241,0.1); }
        .choice-btn.correct { border-color: var(--success); background: rgba(16, 185, 129, 0.15); }
        .choice-btn.incorrect { border-color: var(--error); background: rgba(239, 68, 68, 0.15); }
        .choice-number { width: 24px; height: 24px; border-radius: 6px; background: var(--bg-card); display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.85rem; }
        
        .answer-input-group { display: flex; gap: 10px; margin-bottom: 16px; }
        .answer-input { flex: 1; padding: 12px 16px; border: 1px solid var(--border); background: var(--bg-hover); color: var(--text-primary); font-family: monospace; font-size: 1rem; border-radius: 10px; outline: none; transition: all 0.2s; }
        .answer-input:focus { border-color: var(--accent-1); box-shadow: 0 0 16px var(--glow); }
        .submit-btn { padding: 12px 24px; border: none; background: linear-gradient(135deg, var(--accent-1), var(--accent-2)); color: white; font-family: inherit; font-size: 0.95rem; font-weight: 600; cursor: pointer; border-radius: 10px; transition: all 0.3s; }
        .submit-btn:hover { transform: scale(1.02); box-shadow: 0 4px 16px var(--glow); }
        .submit-btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
        
        .solution-box { background: var(--bg-hover); border-radius: 10px; padding: 16px; margin-top: 12px; display: none; }
        .solution-box.show { display: block; animation: fadeIn 0.3s; }
        .solution-label { font-size: 0.75rem; font-weight: 600; color: var(--accent-1); text-transform: uppercase; letter-spacing: 1px; margin-bottom: 10px; display: flex; align-items: center; gap: 6px; }
        .solution-text { color: var(--text-secondary); line-height: 1.8; white-space: pre-wrap; font-size: 0.95rem; }
        
        .problem-nav { display: flex; justify-content: space-between; align-items: center; margin-top: 16px; padding-top: 16px; border-top: 1px solid var(--border); }
        .nav-btn { padding: 10px 20px; border: 1px solid var(--border); background: var(--bg-card); color: var(--text-primary); font-family: inherit; font-size: 0.85rem; cursor: pointer; border-radius: 8px; transition: all 0.2s; display: flex; align-items: center; gap: 6px; }
        .nav-btn:hover:not(:disabled) { border-color: var(--accent-1); background: var(--bg-hover); }
        .nav-btn:disabled { opacity: 0.3; cursor: not-allowed; }
        .problem-indicator { font-family: monospace; color: var(--text-muted); font-size: 0.85rem; }
        
        .toast { position: fixed; bottom: 24px; left: 50%; transform: translateX(-50%) translateY(80px); background: var(--bg-card); border: 1px solid var(--border); padding: 14px 20px; border-radius: 10px; box-shadow: 0 8px 32px rgba(0,0,0,0.4); z-index: 3000; opacity: 0; transition: all 0.3s; font-size: 0.9rem; }
        .toast.show { transform: translateX(-50%) translateY(0); opacity: 1; }
        .toast.success { border-color: var(--success); }
        .toast.error { border-color: var(--error); }
        
        @media (max-width: 768px) {
            .header-stats { display: none; }
            .grade-tab { padding: 8px 16px; font-size: 0.85rem; }
            .units-grid { grid-template-columns: 1fr; }
            .quick-nav { grid-template-columns: repeat(5, 1fr); }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="logo">
            <div class="logo-icon">M</div>
            <span class="logo-text">ì¤‘í•™ ìˆ˜í•™ 1000ì œ</span>
        </div>
        <div class="header-stats">
            <div class="stat-item"><div class="stat-value" id="totalSolved">0</div><div class="stat-label">ì™„ë£Œ</div></div>
            <div class="stat-item"><div class="stat-value" id="accuracy">0%</div><div class="stat-label">ì •ë‹µë¥ </div></div>
            <div class="stat-item"><div class="stat-value" id="streak">0</div><div class="stat-label">ì—°ì†</div></div>
        </div>
    </header>
    
    <main class="main-content">
        <div class="grade-tabs">
            <button class="grade-tab active" data-grade="1">ì¤‘í•™êµ 1í•™ë…„<span class="badge" id="g1-badge">0%</span></button>
            <button class="grade-tab" data-grade="2">ì¤‘í•™êµ 2í•™ë…„<span class="badge" id="g2-badge">0%</span></button>
            <button class="grade-tab" data-grade="3">ì¤‘í•™êµ 3í•™ë…„<span class="badge" id="g3-badge">0%</span></button>
        </div>
        <div class="content-area">
            <div class="semester-selector">
                <button class="semester-btn active" data-semester="1">1í•™ê¸°</button>
                <button class="semester-btn" data-semester="2">2í•™ê¸°</button>
            </div>
            <div class="units-grid" id="unitsGrid"></div>
        </div>
    </main>
    
    <div class="modal-overlay" id="modalOverlay"></div>
    <div class="modal" id="modal">
        <div class="modal-header">
            <h2 class="modal-title" id="modalTitle">ë‹¨ì›ëª…</h2>
            <button class="modal-close" id="modalClose">âœ•</button>
        </div>
        <div class="modal-body">
            <div class="modal-tabs">
                <button class="modal-tab active" data-tab="concept">ê°œë… ì •ë¦¬</button>
                <button class="modal-tab" data-tab="problems">ë¬¸ì œ í’€ê¸°</button>
            </div>
            <div class="section active" id="conceptSection"></div>
            <div class="section" id="problemsSection">
                <div class="problem-filters" id="problemFilters">
                    <button class="filter-btn active" data-filter="all">ì „ì²´</button>
                    <button class="filter-btn" data-filter="easy">ê¸°ë³¸</button>
                    <button class="filter-btn" data-filter="medium">í‘œì¤€</button>
                    <button class="filter-btn" data-filter="hard">ì‹¬í™”</button>
                    <button class="filter-btn" data-filter="unsolved">ë¯¸ì™„ë£Œ</button>
                </div>
                <div class="quick-nav" id="quickNav"></div>
                <div id="problemContainer"></div>
                <div class="problem-nav">
                    <button class="nav-btn" id="prevBtn">â—€ ì´ì „</button>
                    <span class="problem-indicator" id="problemIndicator">1 / 50</span>
                    <button class="nav-btn" id="nextBtn">ë‹¤ìŒ â–¶</button>
                </div>
            </div>
        </div>
    </div>
    <div class="toast" id="toast"></div>

<script>
// Seeded Random
class Rng{constructor(s){this.s=s}next(){this.s=(this.s*1103515245+12345)&0x7fffffff;return this.s/0x7fffffff}int(a,b){return Math.floor(this.next()*(b-a+1))+a}shuffle(arr){const r=[...arr];for(let i=r.length-1;i>0;i--){const j=Math.floor(this.next()*(i+1));[r[i],r[j]]=[r[j],r[i]]}return r}}

// Math helpers
const gcd=(a,b)=>{a=Math.abs(a);b=Math.abs(b);while(b){[a,b]=[b,a%b]}return a};
const lcm=(a,b)=>(a*b)/gcd(a,b);
const pf=n=>{const f={};let d=2;while(d*d<=n){while(n%d===0){f[d]=(f[d]||0)+1;n/=d}d++}if(n>1)f[n]=(f[n]||0)+1;return Object.entries(f).map(([p,e])=>e>1?`${p}^${e}`:p).join('Ã—')||'1'};
const sf=(n,d)=>{const g=gcd(n,d);return d/g===1?`${n/g}`:`${n/g}/${d/g}`};

// Curriculum Data
const curriculum = {
    1: {
        1: [
            {id:'g1s1u1',title:'ì†Œì¸ìˆ˜ë¶„í•´',topics:['ê±°ë“­ì œê³±','ì†Œìˆ˜','ì†Œì¸ìˆ˜ë¶„í•´','ìµœëŒ€ê³µì•½ìˆ˜','ìµœì†Œê³µë°°ìˆ˜'],problemCount:50,
             concepts:[{title:'ê±°ë“­ì œê³±',icon:'Ã—',content:'<p>ê°™ì€ ìˆ˜ë¥¼ ì—¬ëŸ¬ ë²ˆ ê³±í•œ ê²ƒ</p><div class="formula-box">aâ¿ = a Ã— a Ã— ... Ã— a (nê°œ)</div><div class="example-box"><div class="example-label">ì˜ˆì‹œ</div>2Â³ = 8, 5Â² = 25</div>'},{title:'ì†Œìˆ˜ì™€ í•©ì„±ìˆ˜',icon:'P',content:'<p><b>ì†Œìˆ˜</b>: ì•½ìˆ˜ê°€ 1ê³¼ ìì‹ ë¿ì¸ ìˆ˜ (2,3,5,7,11...)</p><p><b>í•©ì„±ìˆ˜</b>: ì•½ìˆ˜ê°€ 3ê°œ ì´ìƒì¸ ìˆ˜</p><div class="formula-box">1ì€ ì†Œìˆ˜ë„ í•©ì„±ìˆ˜ë„ ì•„ë‹˜</div>'},{title:'ì†Œì¸ìˆ˜ë¶„í•´',icon:'Ã·',content:'<p>ìì—°ìˆ˜ë¥¼ ì†Œìˆ˜ë“¤ì˜ ê³±ìœ¼ë¡œ ë‚˜íƒ€ë‚´ê¸°</p><div class="formula-box">60 = 2Â² Ã— 3 Ã— 5</div>'},{title:'ìµœëŒ€ê³µì•½ìˆ˜/ìµœì†Œê³µë°°ìˆ˜',icon:'G',content:'<p><b>GCD</b>: ê³µí†µ ì†Œì¸ìˆ˜, ì‘ì€ ì§€ìˆ˜</p><p><b>LCM</b>: ëª¨ë“  ì†Œì¸ìˆ˜, í° ì§€ìˆ˜</p><div class="formula-box">GCD(12,18)=6, LCM(12,18)=36</div>'}]},
            {id:'g1s1u2',title:'ì •ìˆ˜ì™€ ìœ ë¦¬ìˆ˜',topics:['ì •ìˆ˜','ìœ ë¦¬ìˆ˜','ì ˆëŒ“ê°’','ì‚¬ì¹™ì—°ì‚°'],problemCount:50,
             concepts:[{title:'ì •ìˆ˜ì™€ ìœ ë¦¬ìˆ˜',icon:'Z',content:'<p><b>ì •ìˆ˜</b>: ...,-2,-1,0,1,2,...</p><p><b>ìœ ë¦¬ìˆ˜</b>: ë¶„ìˆ˜ë¡œ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆëŠ” ìˆ˜</p>'},{title:'ì ˆëŒ“ê°’',icon:'||',content:'<p>ì›ì ì—ì„œì˜ ê±°ë¦¬</p><div class="formula-box">|5| = 5, |-5| = 5</div>'},{title:'ì‚¬ì¹™ì—°ì‚°',icon:'Â±',content:'<p>ë¶€í˜¸ê°€ ê°™ìœ¼ë©´ +, ë‹¤ë¥´ë©´ -</p><div class="formula-box">(-3)Ã—(-5)=+15<br>(-3)Ã—(+5)=-15</div>'}]},
            {id:'g1s1u3',title:'ë¬¸ìì™€ ì‹',topics:['ë¬¸ìì˜ ì‚¬ìš©','ì¼ì°¨ì‹','ì¼ì°¨ë°©ì •ì‹'],problemCount:60,
             concepts:[{title:'ë¬¸ìì˜ ì‚¬ìš©',icon:'x',content:'<p>ëª¨ë¥´ëŠ” ìˆ˜ë¥¼ ë¬¸ìë¡œ í‘œí˜„</p><div class="formula-box">2Ã—x â†’ 2x, xÃ·3 â†’ x/3</div>'},{title:'ì¼ì°¨ë°©ì •ì‹',icon:'=',content:'<p>ax + b = 0 í˜•íƒœì˜ ë°©ì •ì‹</p><div class="formula-box">ì´í•­: ë¶€í˜¸ê°€ ë°”ë€œ<br>3x+5=14 â†’ 3x=9 â†’ x=3</div>'}]},
            {id:'g1s1u4',title:'ì¢Œí‘œí‰ë©´ê³¼ ê·¸ë˜í”„',topics:['ì¢Œí‘œí‰ë©´','ì‚¬ë¶„ë©´','ì •ë¹„ë¡€','ë°˜ë¹„ë¡€'],problemCount:45,
             concepts:[{title:'ì¢Œí‘œí‰ë©´',icon:'âŠ•',content:'<p>ìˆœì„œìŒ (x,y)ë¡œ ì ì˜ ìœ„ì¹˜ í‘œí˜„</p><div class="formula-box">ì œ1ì‚¬ë¶„ë©´(+,+), ì œ2(âˆ’,+)<br>ì œ3(âˆ’,âˆ’), ì œ4(+,âˆ’)</div>'},{title:'ì •ë¹„ë¡€/ë°˜ë¹„ë¡€',icon:'âˆ',content:'<p><b>ì •ë¹„ë¡€</b>: y = ax (ì›ì  ì§€ë‚˜ëŠ” ì§ì„ )</p><p><b>ë°˜ë¹„ë¡€</b>: y = a/x (ìŒê³¡ì„ )</p>'}]}
        ],
        2: [
            {id:'g1s2u1',title:'ê¸°ë³¸ ë„í˜•',topics:['ì ,ì„ ,ë©´','ê°','í‰í–‰ì„ ','ë™ìœ„ê°','ì—‡ê°'],problemCount:40,
             concepts:[{title:'í‰í–‰ì„ ê³¼ ê°',icon:'âˆ ',content:'<p><b>ë§ê¼­ì§€ê°</b>: í¬ê¸°ê°€ ê°™ìŒ</p><p><b>ë™ìœ„ê°/ì—‡ê°</b>: í‰í–‰ì„ ì—ì„œ í¬ê¸° ê°™ìŒ</p><div class="formula-box">í‰í–‰ âŸº ë™ìœ„ê° ê°™ìŒ âŸº ì—‡ê° ê°™ìŒ</div>'}]},
            {id:'g1s2u2',title:'í‰ë©´ë„í˜•',topics:['ë‹¤ê°í˜•','ë‚´ê°','ì™¸ê°','ì›','ë¶€ì±„ê¼´'],problemCount:45,
             concepts:[{title:'ë‹¤ê°í˜•',icon:'â¬¡',content:'<div class="formula-box">ë‚´ê°ì˜ í•© = (n-2)Ã—180Â°<br>ì™¸ê°ì˜ í•© = 360Â°<br>ëŒ€ê°ì„  = n(n-3)/2</div>'},{title:'ì›ê³¼ ë¶€ì±„ê¼´',icon:'â—',content:'<div class="formula-box">ì›ë‘˜ë ˆ = 2Ï€r, ë„“ì´ = Ï€rÂ²<br>ë¶€ì±„ê¼´ í˜¸ = 2Ï€rÃ—(Î¸/360Â°)</div>'}]},
            {id:'g1s2u3',title:'ì…ì²´ë„í˜•',topics:['ë‹¤ë©´ì²´','íšŒì „ì²´','ê²‰ë„“ì´','ë¶€í”¼'],problemCount:45,
             concepts:[{title:'ë¶€í”¼ ê³µì‹',icon:'V',content:'<div class="formula-box">ê¸°ë‘¥: ë°‘ë„“ì´Ã—ë†’ì´<br>ë¿”: (1/3)Ã—ë°‘ë„“ì´Ã—ë†’ì´<br>êµ¬: (4/3)Ï€rÂ³</div>'}]},
            {id:'g1s2u4',title:'í†µê³„',topics:['ë„ìˆ˜ë¶„í¬í‘œ','íˆìŠ¤í† ê·¸ë¨','ìƒëŒ€ë„ìˆ˜'],problemCount:35,
             concepts:[{title:'ìƒëŒ€ë„ìˆ˜',icon:'%',content:'<div class="formula-box">ìƒëŒ€ë„ìˆ˜ = ê³„ê¸‰ë„ìˆ˜/ì „ì²´ë„ìˆ˜<br>ìƒëŒ€ë„ìˆ˜ì˜ í•© = 1</div>'}]}
        ]
    },
    2: {
        1: [
            {id:'g2s1u1',title:'ìœ ë¦¬ìˆ˜ì™€ ìˆœí™˜ì†Œìˆ˜',topics:['ìœ í•œì†Œìˆ˜','ë¬´í•œì†Œìˆ˜','ìˆœí™˜ì†Œìˆ˜'],problemCount:40,
             concepts:[{title:'ìˆœí™˜ì†Œìˆ˜',icon:'â—‹',content:'<p>ì†Œìˆ˜ì  ì•„ë˜ ìˆ«ìê°€ ë°˜ë³µë˜ëŠ” ë¬´í•œì†Œìˆ˜</p><div class="formula-box">0.333... = 1/3<br>ë¶„ëª¨ì— 2,5ì™¸ ì†Œì¸ìˆ˜ â†’ ë¬´í•œì†Œìˆ˜</div>'}]},
            {id:'g2s1u2',title:'ì‹ì˜ ê³„ì‚°',topics:['ì§€ìˆ˜ë²•ì¹™','ë‹¨í•­ì‹','ë‹¤í•­ì‹'],problemCount:50,
             concepts:[{title:'ì§€ìˆ˜ë²•ì¹™',icon:'â¿',content:'<div class="formula-box">aáµÃ—aâ¿ = aáµâºâ¿<br>aáµÃ·aâ¿ = aáµâ»â¿<br>(aáµ)â¿ = aáµâ¿</div>'}]},
            {id:'g2s1u3',title:'ì¼ì°¨ë¶€ë“±ì‹',topics:['ë¶€ë“±ì‹','ì¼ì°¨ë¶€ë“±ì‹','í™œìš©'],problemCount:45,
             concepts:[{title:'ë¶€ë“±ì‹',icon:'<',content:'<p>ìŒìˆ˜ë¡œ ê³±/ë‚˜ëˆ„ë©´ ë¶€ë“±í˜¸ ë°©í–¥ ë°”ë€œ!</p><div class="formula-box">-2x > 6 â†’ x < -3</div>'}]},
            {id:'g2s1u4',title:'ì—°ë¦½ì¼ì°¨ë°©ì •ì‹',topics:['ê°€ê°ë²•','ëŒ€ì…ë²•','í™œìš©'],problemCount:55,
             concepts:[{title:'í’€ì´ë²•',icon:'{}',content:'<p><b>ê°€ê°ë²•</b>: ë”í•˜ê±°ë‚˜ ë¹¼ì„œ ì†Œê±°</p><p><b>ëŒ€ì…ë²•</b>: í•œ ì‹ì„ ë‹¤ë¥¸ ì‹ì— ëŒ€ì…</p>'}]},
            {id:'g2s1u5',title:'ì¼ì°¨í•¨ìˆ˜',topics:['ê¸°ìš¸ê¸°','yì ˆí¸','ê·¸ë˜í”„'],problemCount:55,
             concepts:[{title:'ì¼ì°¨í•¨ìˆ˜',icon:'/',content:'<div class="formula-box">y = ax + b<br>a: ê¸°ìš¸ê¸°, b: yì ˆí¸<br>ê¸°ìš¸ê¸° = (yâ‚‚-yâ‚)/(xâ‚‚-xâ‚)</div>'}]}
        ],
        2: [
            {id:'g2s2u1',title:'ì‚¼ê°í˜•ì˜ ì„±ì§ˆ',topics:['ì´ë“±ë³€ì‚¼ê°í˜•','í•©ë™ì¡°ê±´','ì™¸ì‹¬','ë‚´ì‹¬'],problemCount:50,
             concepts:[{title:'í•©ë™ì¡°ê±´',icon:'â‰¡',content:'<div class="formula-box">SSS, SAS, ASA<br>ì§ê°ì‚¼ê°í˜•: RHS, RHA</div>'},{title:'ì™¸ì‹¬/ë‚´ì‹¬',icon:'âŠ™',content:'<p><b>ì™¸ì‹¬</b>: ìˆ˜ì§ì´ë“±ë¶„ì„  êµì </p><p><b>ë‚´ì‹¬</b>: ê°ì˜ ì´ë“±ë¶„ì„  êµì </p>'}]},
            {id:'g2s2u2',title:'ì‚¬ê°í˜•ì˜ ì„±ì§ˆ',topics:['í‰í–‰ì‚¬ë³€í˜•','ì§ì‚¬ê°í˜•','ë§ˆë¦„ëª¨','ì •ì‚¬ê°í˜•'],problemCount:45,
             concepts:[{title:'í‰í–‰ì‚¬ë³€í˜•',icon:'â–±',content:'<div class="formula-box">ëŒ€ë³€ í‰í–‰, ëŒ€ë³€/ëŒ€ê° ê°™ìŒ<br>ëŒ€ê°ì„ ì´ ì„œë¡œ ì´ë“±ë¶„</div>'}]},
            {id:'g2s2u3',title:'ë„í˜•ì˜ ë‹®ìŒ',topics:['ë‹®ìŒë¹„','ë‹®ìŒì¡°ê±´','ë¬´ê²Œì¤‘ì‹¬'],problemCount:50,
             concepts:[{title:'ë‹®ìŒ',icon:'âˆ¼',content:'<div class="formula-box">ë‹®ìŒë¹„ m:nì´ë©´<br>ë„“ì´ë¹„ = mÂ²:nÂ²<br>ë¶€í”¼ë¹„ = mÂ³:nÂ³</div>'},{title:'ë¬´ê²Œì¤‘ì‹¬',icon:'G',content:'<div class="formula-box">ì„¸ ì¤‘ì„ ì˜ êµì <br>ê¼­ì§“ì ì—ì„œ 2:1ë¡œ ë‚˜ëˆ”</div>'}]},
            {id:'g2s2u4',title:'í”¼íƒ€ê³ ë¼ìŠ¤ ì •ë¦¬',topics:['í”¼íƒ€ê³ ë¼ìŠ¤ ì •ë¦¬','ì—­','í™œìš©'],problemCount:45,
             concepts:[{title:'í”¼íƒ€ê³ ë¼ìŠ¤',icon:'cÂ²',content:'<div class="formula-box">aÂ² + bÂ² = cÂ² (ë¹—ë³€)<br>3,4,5 / 5,12,13 / 8,15,17</div>'}]},
            {id:'g2s2u5',title:'í™•ë¥ ',topics:['ê²½ìš°ì˜ ìˆ˜','í•©/ê³±ì˜ ë²•ì¹™','í™•ë¥ '],problemCount:45,
             concepts:[{title:'í™•ë¥ ',icon:'P',content:'<div class="formula-box">í™•ë¥  = í•´ë‹¹ ê²½ìš°/ì „ì²´ ê²½ìš°<br>0 â‰¤ P â‰¤ 1</div>'}]}
        ]
    },
    3: {
        1: [
            {id:'g3s1u1',title:'ì‹¤ìˆ˜ì™€ ê·¸ ì—°ì‚°',topics:['ì œê³±ê·¼','ë¬´ë¦¬ìˆ˜','ì‹¤ìˆ˜','ìœ ë¦¬í™”'],problemCount:50,
             concepts:[{title:'ì œê³±ê·¼',icon:'âˆš',content:'<div class="formula-box">âˆša: aì˜ ì–‘ì˜ ì œê³±ê·¼<br>(âˆša)Â² = a, âˆš(aÂ²) = |a|</div>'},{title:'ìœ ë¦¬í™”',icon:'Ã—âˆš',content:'<div class="formula-box">1/âˆša = âˆša/a<br>âˆšaÃ—âˆšb = âˆš(ab)</div>'}]},
            {id:'g3s1u2',title:'ë‹¤í•­ì‹ì˜ ê³±ì…ˆê³¼ ì¸ìˆ˜ë¶„í•´',topics:['ê³±ì…ˆê³µì‹','ì¸ìˆ˜ë¶„í•´'],problemCount:55,
             concepts:[{title:'ê³±ì…ˆê³µì‹',icon:'Â²',content:'<div class="formula-box">(a+b)Â² = aÂ²+2ab+bÂ²<br>(a-b)Â² = aÂ²-2ab+bÂ²<br>(a+b)(a-b) = aÂ²-bÂ²</div>'},{title:'ì¸ìˆ˜ë¶„í•´',icon:'()',content:'<div class="formula-box">aÂ²Â±2ab+bÂ² = (aÂ±b)Â²<br>aÂ²-bÂ² = (a+b)(a-b)<br>xÂ²+(a+b)x+ab = (x+a)(x+b)</div>'}]},
            {id:'g3s1u3',title:'ì´ì°¨ë°©ì •ì‹',topics:['ì¸ìˆ˜ë¶„í•´','ì œê³±ê·¼','ê·¼ì˜ê³µì‹'],problemCount:55,
             concepts:[{title:'í’€ì´ë²•',icon:'xÂ²',content:'<div class="formula-box">ì¸ìˆ˜ë¶„í•´: (x-a)(x-b)=0<br>ì œê³±ê·¼: (x-p)Â²=q<br>ê·¼ì˜ê³µì‹: x=(-bÂ±âˆš(bÂ²-4ac))/2a</div>'},{title:'íŒë³„ì‹',icon:'D',content:'<div class="formula-box">D = bÂ²-4ac<br>D>0: ì„œë¡œ ë‹¤ë¥¸ ë‘ ê·¼<br>D=0: ì¤‘ê·¼<br>D<0: ì‹¤ê·¼ ì—†ìŒ</div>'}]},
            {id:'g3s1u4',title:'ì´ì°¨í•¨ìˆ˜',topics:['y=axÂ²','í‰í–‰ì´ë™','ê¼­ì§“ì ','ìµœëŒ€/ìµœì†Œ'],problemCount:55,
             concepts:[{title:'ì´ì°¨í•¨ìˆ˜',icon:'âˆª',content:'<div class="formula-box">y = a(x-p)Â² + q<br>ê¼­ì§“ì : (p,q), ì¶•: x=p<br>a>0: ì•„ë˜ë³¼ë¡, ìµœì†Ÿê°’ q<br>a<0: ìœ„ë³¼ë¡, ìµœëŒ“ê°’ q</div>'}]}
        ],
        2: [
            {id:'g3s2u1',title:'ì‚¼ê°ë¹„',topics:['sin','cos','tan','íŠ¹ìˆ˜ê°','í™œìš©'],problemCount:50,
             concepts:[{title:'ì‚¼ê°ë¹„',icon:'Î¸',content:'<div class="formula-box">sin = ëŒ€ë³€/ë¹—ë³€<br>cos = ì¸ì ‘ë³€/ë¹—ë³€<br>tan = ëŒ€ë³€/ì¸ì ‘ë³€</div>'},{title:'íŠ¹ìˆ˜ê°',icon:'30Â°',content:'<div class="formula-box">sin30Â°=1/2, cos30Â°=âˆš3/2<br>sin45Â°=cos45Â°=âˆš2/2<br>sin60Â°=âˆš3/2, cos60Â°=1/2</div>'}]},
            {id:'g3s2u2',title:'ì›ì˜ ì„±ì§ˆ',topics:['í˜„','ì ‘ì„ ','ì›ì£¼ê°','ì¤‘ì‹¬ê°'],problemCount:50,
             concepts:[{title:'ì›ì£¼ê°',icon:'âˆ ',content:'<div class="formula-box">ì›ì£¼ê° = ì¤‘ì‹¬ê°/2<br>ê°™ì€ í˜¸ â†’ ì›ì£¼ê° ê°™ìŒ<br>ë°˜ì› â†’ ì›ì£¼ê° 90Â°</div>'}]},
            {id:'g3s2u3',title:'í†µê³„',topics:['ëŒ€í‘¯ê°’','ë¶„ì‚°','í‘œì¤€í¸ì°¨','ìƒê´€ê´€ê³„'],problemCount:45,
             concepts:[{title:'ì‚°í¬ë„',icon:'Ïƒ',content:'<div class="formula-box">ë¶„ì‚° = Î£(í¸ì°¨Â²)/n<br>í‘œì¤€í¸ì°¨ = âˆšë¶„ì‚°</div>'},{title:'ìƒê´€ê´€ê³„',icon:'â†—',content:'<div class="formula-box">ì–‘ì˜ ìƒê´€: xâ†‘ â†’ yâ†‘<br>ìŒì˜ ìƒê´€: xâ†‘ â†’ yâ†“</div>'}]}
        ]
    }
};

// Problem Generators
const gen = {
    'g1s1u1': [
        (r,i)=>{const b=r.int(2,9),e=r.int(2,4),a=Math.pow(b,e);return{type:'input',diff:'easy',text:`${b}ì˜ ${e}ì œê³±ì˜ ê°’ì€?`,ans:a+'',sol:`${b}^${e} = ${a}`}},
        (r,i)=>{const nums=[12,18,24,30,36,40,48,60,72,84];const n=nums[r.int(0,nums.length-1)];return{type:'input',diff:'medium',text:`${n}ì„ ì†Œì¸ìˆ˜ë¶„í•´í•˜ì‹œì˜¤. (ì˜ˆ: 2^2Ã—3)`,ans:pf(n),sol:`${n} = ${pf(n)}`}},
        (r,i)=>{const pairs=[[12,18],[24,36],[20,30],[15,25],[18,24]];const[a,b]=pairs[r.int(0,pairs.length-1)];const g=gcd(a,b);return{type:'input',diff:'medium',text:`${a}ê³¼ ${b}ì˜ ìµœëŒ€ê³µì•½ìˆ˜ëŠ”?`,ans:g+'',sol:`GCD(${a},${b}) = ${g}`}},
        (r,i)=>{const pairs=[[4,6],[6,9],[8,12],[10,15]];const[a,b]=pairs[r.int(0,pairs.length-1)];const l=lcm(a,b);return{type:'input',diff:'medium',text:`${a}ê³¼ ${b}ì˜ ìµœì†Œê³µë°°ìˆ˜ëŠ”?`,ans:l+'',sol:`LCM(${a},${b}) = ${l}`}}
    ],
    'g1s1u2': [
        (r,i)=>{const a=r.int(-12,12),b=r.int(-12,12);return{type:'input',diff:'easy',text:`(${a}) + (${b}) = ?`,ans:(a+b)+'',sol:`${a}+${b}=${a+b}`}},
        (r,i)=>{const a=r.int(-10,10),b=r.int(-10,10);if(a===0||b===0)return gen['g1s1u2'][1](r,i);return{type:'input',diff:'easy',text:`(${a}) Ã— (${b}) = ?`,ans:(a*b)+'',sol:`ë¶€í˜¸ê°€ ${(a>0)===(b>0)?'ê°™ìœ¼ë©´ +':'ë‹¤ë¥´ë©´ -'}: ${a*b}`}},
        (r,i)=>{const a=r.int(-15,15);return{type:'input',diff:'easy',text:`|${a}|ì˜ ê°’ì€?`,ans:Math.abs(a)+'',sol:`|${a}| = ${Math.abs(a)}`}}
    ],
    'g1s1u3': [
        (r,i)=>{const a=r.int(2,8),b=r.int(1,12);const x=b/a;if(!Number.isInteger(x))return gen['g1s1u3'][0](r,i+1);return{type:'input',diff:'easy',text:`${a}x = ${b}ì¼ ë•Œ xëŠ”?`,ans:x+'',sol:`x = ${b}Ã·${a} = ${x}`}},
        (r,i)=>{const a=r.int(2,5),b=r.int(1,8),c=r.int(5,20);const x=(c-b)/a;if(!Number.isInteger(x)||x<0)return gen['g1s1u3'][1](r,i+1);return{type:'input',diff:'medium',text:`${a}x + ${b} = ${c}ì¼ ë•Œ xëŠ”?`,ans:x+'',sol:`${a}x=${c-b}, x=${x}`}},
        (r,i)=>{const c1=r.int(2,6),c2=r.int(2,6);return{type:'input',diff:'easy',text:`${c1}x + ${c2}xë¥¼ ê³„ì‚°í•˜ë©´? (ì˜ˆ: 5x)`,ans:`${c1+c2}x`,sol:`${c1}x+${c2}x=${c1+c2}x`}}
    ],
    'g1s1u4': [
        (r,i)=>{const a=r.int(2,6),x=r.int(1,5);return{type:'input',diff:'easy',text:`y=${a}xì—ì„œ x=${x}ì¼ ë•Œ yëŠ”?`,ans:(a*x)+'',sol:`y=${a}Ã—${x}=${a*x}`}},
        (r,i)=>{const a=r.int(6,30),x=r.int(2,5);if(a%x!==0)return gen['g1s1u4'][1](r,i+1);return{type:'input',diff:'medium',text:`y=${a}/xì—ì„œ x=${x}ì¼ ë•Œ yëŠ”?`,ans:(a/x)+'',sol:`y=${a}/${x}=${a/x}`}},
        (r,i)=>{const x=r.int(-4,4),y=r.int(-4,4);if(x===0||y===0)return gen['g1s1u4'][2](r,i+1);const q=x>0&&y>0?1:x<0&&y>0?2:x<0&&y<0?3:4;return{type:'input',diff:'easy',text:`ì  (${x},${y})ëŠ” ì œ ëª‡ ì‚¬ë¶„ë©´? (ìˆ«ìë§Œ)`,ans:q+'',sol:`(${x>0?'+':'-'},${y>0?'+':'-'}) â†’ ì œ${q}ì‚¬ë¶„ë©´`}}
    ],
    'g1s2u1': [
        (r,i)=>{const a=r.int(30,150);return{type:'input',diff:'easy',text:`ë§ê¼­ì§€ê°ì´ ${a}Â°ì¼ ë•Œ ë°˜ëŒ€í¸ ë§ê¼­ì§€ê°ì€?`,ans:a+'',sol:`ë§ê¼­ì§€ê°ì€ ê°™ë‹¤: ${a}Â°`}},
        (r,i)=>{const a=r.int(40,140);return{type:'input',diff:'easy',text:`í‰í–‰ì„ ì—ì„œ ë™ìœ„ê°ì´ ${a}Â°ì¼ ë•Œ ì—‡ê°ì€?`,ans:a+'',sol:`í‰í–‰ì„ ì—ì„œ ë™ìœ„ê°=ì—‡ê°: ${a}Â°`}}
    ],
    'g1s2u2': [
        (r,i)=>{const n=r.int(5,8);const a=(n-2)*180;return{type:'input',diff:'easy',text:`${n}ê°í˜•ì˜ ë‚´ê°ì˜ í•©ì€? (ë„)`,ans:a+'',sol:`(${n}-2)Ã—180=${a}Â°`}},
        (r,i)=>{const rd=r.int(2,8);return{type:'input',diff:'easy',text:`ë°˜ì§€ë¦„ ${rd}cmì¸ ì›ì˜ ë‘˜ë ˆëŠ”? (Ï€ ì‚¬ìš©)`,ans:`${2*rd}Ï€`,sol:`2Ï€Ã—${rd}=${2*rd}Ï€ cm`}},
        (r,i)=>{const n=r.int(4,8);const d=n*(n-3)/2;return{type:'input',diff:'medium',text:`${n}ê°í˜•ì˜ ëŒ€ê°ì„  ê°œìˆ˜ëŠ”?`,ans:d+'',sol:`${n}(${n}-3)/2=${d}`}}
    ],
    'g1s2u3': [
        (r,i)=>{const rd=r.int(2,5),h=r.int(3,8);return{type:'input',diff:'medium',text:`ë°‘ë©´ ë°˜ì§€ë¦„ ${rd}cm, ë†’ì´ ${h}cmì¸ ì›ê¸°ë‘¥ ë¶€í”¼ëŠ”? (Ï€ ì‚¬ìš©)`,ans:`${rd*rd*h}Ï€`,sol:`Ï€Ã—${rd}Â²Ã—${h}=${rd*rd*h}Ï€ cmÂ³`}},
        (r,i)=>{const rd=r.int(3,6),h=r.int(3,9);const v=(rd*rd*h);if(v%3!==0)return gen['g1s2u3'][1](r,i+1);return{type:'input',diff:'hard',text:`ë°‘ë©´ ë°˜ì§€ë¦„ ${rd}cm, ë†’ì´ ${h}cmì¸ ì›ë¿” ë¶€í”¼ëŠ”? (Ï€ ì‚¬ìš©)`,ans:`${v/3}Ï€`,sol:`(1/3)Ã—Ï€Ã—${rd}Â²Ã—${h}=${v/3}Ï€ cmÂ³`}}
    ],
    'g1s2u4': [
        (r,i)=>{const vals=[70,80,90,85,75];const m=80;return{type:'input',diff:'easy',text:`ìë£Œ ${vals.join(', ')}ì˜ í‰ê· ì€?`,ans:m+'',sol:`(${vals.join('+')})/5=${m}`}},
        (r,i)=>{const tot=r.int(2,5)*10,freq=r.int(4,tot/2);const rd=freq/tot;return{type:'input',diff:'medium',text:`ì „ì²´ë„ìˆ˜ ${tot}, ê³„ê¸‰ë„ìˆ˜ ${freq}ì¼ ë•Œ ìƒëŒ€ë„ìˆ˜ëŠ”?`,ans:rd+'',sol:`${freq}/${tot}=${rd}`}}
    ],
    'g2s1u1': [
        (r,i)=>{const rep=r.int(1,9);const g=gcd(rep,9);return{type:'input',diff:'medium',text:`0.${rep}${rep}${rep}...ì„ ë¶„ìˆ˜ë¡œ (ê¸°ì•½ë¶„ìˆ˜)`,ans:sf(rep,9),sol:`x=0.${rep}..., 9x=${rep}, x=${sf(rep,9)}`}}
    ],
    'g2s1u2': [
        (r,i)=>{const b=r.int(2,4),m=r.int(2,4),n=r.int(2,4);return{type:'input',diff:'easy',text:`${b}^${m} Ã— ${b}^${n} = ? (ì˜ˆ: 2^5)`,ans:`${b}^${m+n}`,sol:`${b}^${m}Ã—${b}^${n}=${b}^${m+n}`}},
        (r,i)=>{const b=r.int(2,4),m=r.int(2,3),n=r.int(2,3);return{type:'input',diff:'medium',text:`(${b}^${m})^${n} = ? (ì˜ˆ: 2^6)`,ans:`${b}^${m*n}`,sol:`(${b}^${m})^${n}=${b}^${m*n}`}}
    ],
    'g2s1u3': [
        (r,i)=>{const a=r.int(2,5),b=r.int(6,20);const x=b/a;if(!Number.isInteger(x))return gen['g2s1u3'][0](r,i+1);return{type:'input',diff:'easy',text:`${a}x < ${b}ì˜ í•´ëŠ”? (ì˜ˆ: x<5)`,ans:`x<${x}`,sol:`x<${b}/${a}=${x}`}},
        (r,i)=>{const a=r.int(2,4),b=r.int(6,15);const x=b/a;if(!Number.isInteger(x))return gen['g2s1u3'][1](r,i+1);return{type:'input',diff:'medium',text:`-${a}x < ${b}ì˜ í•´ëŠ”?`,ans:`x>-${x}`,sol:`ìŒìˆ˜ë¡œ ë‚˜ëˆ„ë©´ ë¶€ë“±í˜¸ ë°˜ëŒ€! x>-${x}`}}
    ],
    'g2s1u4': [
        (r,i)=>{const x=r.int(2,5),y=r.int(1,4);const s=x+y,d=x-y;if(d<=0)return gen['g2s1u4'][0](r,i+1);return{type:'input',diff:'medium',text:`x+y=${s}, x-y=${d}ì¼ ë•Œ (x,y)ëŠ”? (ì˜ˆ: 3,2)`,ans:`${x},${y}`,sol:`ë”í•˜ë©´ 2x=${s+d}, x=${x}, y=${y}`}}
    ],
    'g2s1u5': [
        (r,i)=>{const a=r.int(1,4),b=r.int(-4,4);return{type:'input',diff:'easy',text:`y=${a}x${b>=0?'+':''}${b}ì˜ ê¸°ìš¸ê¸°ëŠ”?`,ans:a+'',sol:`y=ax+bì—ì„œ ê¸°ìš¸ê¸°=a=${a}`}},
        (r,i)=>{const a=r.int(1,4),b=r.int(-5,5);return{type:'input',diff:'easy',text:`y=${a}x${b>=0?'+':''}${b}ì˜ yì ˆí¸ì€?`,ans:b+'',sol:`y=ax+bì—ì„œ yì ˆí¸=b=${b}`}}
    ],
    'g2s2u1': [
        (r,i)=>{const v=r.int(40,100);if((180-v)%2!==0)return gen['g2s2u1'][0](r,i+1);const b=(180-v)/2;return{type:'input',diff:'easy',text:`ì´ë“±ë³€ì‚¼ê°í˜• ê¼­ì§€ê°ì´ ${v}Â°ì¼ ë•Œ ë°‘ê°ì€?`,ans:b+'',sol:`(180-${v})/2=${b}Â°`}}
    ],
    'g2s2u2': [
        (r,i)=>{const a=r.int(50,130);return{type:'input',diff:'easy',text:`í‰í–‰ì‚¬ë³€í˜•ì˜ í•œ ê°ì´ ${a}Â°ì¼ ë•Œ ì´ì›ƒí•œ ê°ì€?`,ans:(180-a)+'',sol:`180-${a}=${180-a}Â°`}}
    ],
    'g2s2u3': [
        (r,i)=>{const m=r.int(2,4),n=1;return{type:'input',diff:'medium',text:`ë‹®ìŒë¹„ ${m}:${n}ì¼ ë•Œ ë„“ì´ë¹„ëŠ”? (ì˜ˆ: 4:1)`,ans:`${m*m}:${n*n}`,sol:`ë„“ì´ë¹„=ë‹®ìŒë¹„Â²=${m*m}:${n*n}`}}
    ],
    'g2s2u4': [
        (r,i)=>{const trips=[[3,4,5],[5,12,13],[6,8,10],[8,15,17]];const[a,b,c]=trips[r.int(0,trips.length-1)];return{type:'input',diff:'easy',text:`ì§ê°ì‚¼ê°í˜•ì—ì„œ ë‘ ë³€ì´ ${a}, ${b}ì¼ ë•Œ ë¹—ë³€ì€?`,ans:c+'',sol:`${a}Â²+${b}Â²=${a*a+b*b}=${c}Â²`}}
    ],
    'g2s2u5': [
        (r,i)=>{const a=r.int(3,6),b=r.int(2,5);return{type:'input',diff:'easy',text:`ì…”ì¸  ${a}ë²Œ, ë°”ì§€ ${b}ë²Œì¼ ë•Œ ê²½ìš°ì˜ ìˆ˜ëŠ”?`,ans:(a*b)+'',sol:`ê³±ì˜ë²•ì¹™: ${a}Ã—${b}=${a*b}`}},
        (r,i)=>{return{type:'input',diff:'medium',text:`ì£¼ì‚¬ìœ„ì—ì„œ ì§ìˆ˜ê°€ ë‚˜ì˜¬ í™•ë¥ ì€? (ê¸°ì•½ë¶„ìˆ˜)`,ans:'1/2',sol:`ì§ìˆ˜: 2,4,6 â†’ 3/6=1/2`}}
    ],
    'g3s1u1': [
        (r,i)=>{const sq=[4,9,16,25,36,49,64,81];const n=sq[r.int(0,sq.length-1)];return{type:'input',diff:'easy',text:`âˆš${n}ì˜ ê°’ì€?`,ans:Math.sqrt(n)+'',sol:`âˆš${n}=${Math.sqrt(n)}`}},
        (r,i)=>{const a=r.int(2,8);return{type:'input',diff:'easy',text:`(âˆš${a})Â²ì˜ ê°’ì€?`,ans:a+'',sol:`(âˆša)Â²=a â†’ ${a}`}},
        (r,i)=>{const a=r.int(2,5),b=r.int(2,5);return{type:'input',diff:'medium',text:`âˆš${a}Ã—âˆš${b}ë¥¼ ê°„ë‹¨íˆ (ì˜ˆ: âˆš6)`,ans:`âˆš${a*b}`,sol:`âˆš${a}Ã—âˆš${b}=âˆš${a*b}`}}
    ],
    'g3s1u2': [
        (r,i)=>{const a=r.int(2,5);return{type:'input',diff:'easy',text:`(x+${a})Â²ì„ ì „ê°œ (ì˜ˆ: x^2+6x+9)`,ans:`x^2+${2*a}x+${a*a}`,sol:`xÂ²+${2*a}x+${a*a}`}},
        (r,i)=>{const a=r.int(2,6);return{type:'input',diff:'easy',text:`(x+${a})(x-${a})ë¥¼ ì „ê°œ (ì˜ˆ: x^2-9)`,ans:`x^2-${a*a}`,sol:`xÂ²-${a*a}`}},
        (r,i)=>{const a=r.int(2,5);return{type:'input',diff:'medium',text:`xÂ²-${a*a}ì„ ì¸ìˆ˜ë¶„í•´`,ans:`(x+${a})(x-${a})`,sol:`xÂ²-${a}Â²=(x+${a})(x-${a})`}}
    ],
    'g3s1u3': [
        (r,i)=>{const a=r.int(1,5),b=r.int(1,5);if(a===b)return gen['g3s1u3'][0](r,i+1);return{type:'input',diff:'medium',text:`xÂ²+${a+b}x+${a*b}=0ì˜ í•´ëŠ”? (ì‘ì€ ìˆ˜ë¶€í„°)`,ans:`-${Math.max(a,b)},-${Math.min(a,b)}`,sol:`(x+${a})(x+${b})=0 â†’ x=-${a},-${b}`}},
        (r,i)=>{const a=r.int(2,6);return{type:'input',diff:'easy',text:`xÂ²=${a*a}ì˜ í•´ëŠ”? (ì˜ˆ: -3,3)`,ans:`-${a},${a}`,sol:`x=Â±${a}`}}
    ],
    'g3s1u4': [
        (r,i)=>{const a=r.int(1,3)*(r.next()>0.5?1:-1);const shape=a>0?'ì•„ë˜ë¡œ ë³¼ë¡':'ìœ„ë¡œ ë³¼ë¡';return{type:'choice',diff:'easy',text:`y=${a}xÂ²ì˜ ëª¨ì–‘ì€?`,choices:['ì•„ë˜ë¡œ ë³¼ë¡','ìœ„ë¡œ ë³¼ë¡'],ans:a>0?0:1,sol:`a=${a}${a>0?'>0':'<0'} â†’ ${shape}`}},
        (r,i)=>{const p=r.int(-3,3),q=r.int(-4,4);return{type:'input',diff:'medium',text:`y=2(x-${p})Â²+${q}ì˜ ê¼­ì§“ì ì€? (ì˜ˆ: 2,3)`,ans:`${p},${q}`,sol:`ê¼­ì§“ì : (${p},${q})`}}
    ],
    'g3s2u1': [
        (r,i)=>{const angs=[{d:30,s:'1/2',c:'âˆš3/2',t:'âˆš3/3'},{d:45,s:'âˆš2/2',c:'âˆš2/2',t:'1'},{d:60,s:'âˆš3/2',c:'1/2',t:'âˆš3'}];const a=angs[r.int(0,2)];const f=['sin','cos','tan'][r.int(0,2)];const v=f==='sin'?a.s:f==='cos'?a.c:a.t;return{type:'input',diff:'easy',text:`${f} ${a.d}Â°ì˜ ê°’ì€?`,ans:v,sol:`${f} ${a.d}Â°=${v}`}}
    ],
    'g3s2u2': [
        (r,i)=>{const c=r.int(40,160);if(c%2!==0)return gen['g3s2u2'][0](r,i+1);return{type:'input',diff:'easy',text:`ì¤‘ì‹¬ê°ì´ ${c}Â°ì¼ ë•Œ ì›ì£¼ê°ì€?`,ans:(c/2)+'',sol:`ì›ì£¼ê°=ì¤‘ì‹¬ê°/2=${c/2}Â°`}},
        (r,i)=>{return{type:'input',diff:'easy',text:`ë°˜ì›ì— ëŒ€í•œ ì›ì£¼ê°ì€?`,ans:'90',sol:`ë°˜ì› ì¤‘ì‹¬ê°=180Â°, ì›ì£¼ê°=90Â°`}}
    ],
    'g3s2u3': [
        (r,i)=>{const vals=[2,4,6,8,10];return{type:'input',diff:'medium',text:`ìë£Œ 2,4,6,8,10ì˜ ë¶„ì‚°ì€?`,ans:'8',sol:`í‰ê· =6, í¸ì°¨Â²í•©=40, ë¶„ì‚°=8`}},
        (r,i)=>{const v=[4,9,16,25][r.int(0,3)];return{type:'input',diff:'easy',text:`ë¶„ì‚°ì´ ${v}ì´ë©´ í‘œì¤€í¸ì°¨ëŠ”?`,ans:Math.sqrt(v)+'',sol:`âˆš${v}=${Math.sqrt(v)}`}}
    ]
};

// State
const state={grade:1,semester:1,unit:null,probIdx:0,filter:'all',problems:[],progress:{},stats:{total:0,correct:0,streak:0}};

function load(){try{const d=localStorage.getItem('mwb');if(d){const p=JSON.parse(d);state.progress=p.progress||{};state.stats=p.stats||{total:0,correct:0,streak:0}}}catch(e){console.warn('localStorage load failed:',e)}updateStats();updateBadges()}
function save(){try{localStorage.setItem('mwb',JSON.stringify({progress:state.progress,stats:state.stats}))}catch(e){console.warn('localStorage save failed:',e)}updateStats();updateBadges()}
function updateStats(){document.getElementById('totalSolved').textContent=state.stats.total;const acc=state.stats.total>0?Math.round(state.stats.correct/state.stats.total*100):0;document.getElementById('accuracy').textContent=acc+'%';document.getElementById('streak').textContent=state.stats.streak}
function updateBadges(){[1,2,3].forEach(g=>{const units=[...(curriculum[g][1]||[]),...(curriculum[g][2]||[])];let t=0,s=0;units.forEach(u=>{t+=u.problemCount;const up=state.progress[u.id]||{};s+=Object.keys(up).filter(k=>up[k]).length});document.getElementById(`g${g}-badge`).textContent=Math.round(s/t*100)+'%'})}

function renderUnits(){const grid=document.getElementById('unitsGrid');const units=curriculum[state.grade][state.semester]||[];grid.innerHTML=units.map((u,i)=>{const up=state.progress[u.id]||{};const solved=Object.keys(up).filter(k=>up[k]).length;const pct=Math.round(solved/u.problemCount*100);return`<div class="unit-card" onclick="openUnit('${u.id}')"><div class="unit-header"><div class="unit-number">ë‹¨ì› ${i+1}</div><div class="unit-title">${u.title}</div><div class="unit-progress"><div class="progress-bar"><div class="progress-fill" style="width:${pct}%"></div></div><span class="progress-text">${solved}/${u.problemCount}</span></div></div><div class="unit-body"><div class="unit-topics">${u.topics.map(t=>`<span class="topic-tag">${t}</span>`).join('')}</div></div></div>`}).join('')}

function openUnit(id){const all=Object.values(curriculum).flatMap(g=>Object.values(g).flat());state.unit=all.find(u=>u.id===id);if(!state.unit)return;genProblems();state.probIdx=0;state.filter='all';document.getElementById('modalTitle').textContent=state.unit.title;renderConcepts();renderProblem();updateNav();document.getElementById('modal').classList.add('active');document.getElementById('modalOverlay').classList.add('active');document.querySelectorAll('.modal-tab').forEach(t=>t.classList.remove('active'));document.querySelector('.modal-tab[data-tab="concept"]').classList.add('active');document.getElementById('conceptSection').classList.add('active');document.getElementById('problemsSection').classList.remove('active')}
function closeModal(){document.getElementById('modal').classList.remove('active');document.getElementById('modalOverlay').classList.remove('active')}

function renderConcepts(){const sec=document.getElementById('conceptSection');if(!state.unit)return;sec.innerHTML=(state.unit.concepts||[]).map((c,i)=>`<div class="concept-block ${i===0?'open':''}" onclick="this.classList.toggle('open')"><div class="concept-header"><div class="concept-title"><span class="concept-icon">${c.icon}</span>${c.title}</div><span class="concept-toggle">â–¼</span></div><div class="concept-content"><div class="concept-inner">${c.content}</div></div></div>`).join('')}

function genProblems(){if(!state.unit)return;const id=state.unit.id;const gs=gen[id]||[];const cnt=state.unit.problemCount;state.problems=[];const rng=new Rng(id.split('').reduce((a,c)=>a+c.charCodeAt(0),0));for(let i=0;i<cnt;i++){const g=gs[i%gs.length];if(g){const p=g(rng,i);p.id=`${id}_${i}`;if(!p.diff)p.diff=['easy','medium','hard'][i%3];state.problems.push(p)}}}

function getFiltered(){if(state.filter==='all')return state.problems;if(state.filter==='unsolved')return state.problems.filter((p,i)=>{const pr=state.progress[state.unit.id]||{};return!pr[i]});return state.problems.filter(p=>p.diff===state.filter)}

function renderProblem(){const cont=document.getElementById('problemContainer');const filt=getFiltered();if(!filt.length){cont.innerHTML='<div style="text-align:center;padding:40px;color:var(--text-muted)">í•´ë‹¹ ì¡°ê±´ì˜ ë¬¸ì œê°€ ì—†ìŠµë‹ˆë‹¤</div>';return}const realIdx=state.problems.indexOf(filt[state.probIdx]);const p=filt[state.probIdx];const pr=state.progress[state.unit.id]||{};const status=pr[realIdx];const dc={easy:'difficulty-easy',medium:'difficulty-medium',hard:'difficulty-hard'}[p.diff];const dl={easy:'ê¸°ë³¸',medium:'í‘œì¤€',hard:'ì‹¬í™”'}[p.diff];let sc='';if(status==='correct')sc='solved';else if(status==='wrong')sc='wrong';cont.innerHTML=`<div class="problem-card ${sc}"><div class="problem-meta"><span class="problem-number">ë¬¸ì œ ${realIdx+1}</span><span class="problem-difficulty ${dc}">${dl}</span></div><div class="problem-text">${p.text}</div>${p.type==='choice'?renderChoices(p,status):renderInput(p,status)}<div class="solution-box ${status?'show':''}" id="solBox"><div class="solution-label">ğŸ’¡ í’€ì´</div><div class="solution-text">${p.sol}</div></div></div>`;updateProbNav()}

function renderChoices(p,status){return`<div class="problem-choices">${p.choices.map((c,i)=>{let cls='choice-btn';if(status){if(i===p.ans)cls+=' correct';else if(status==='wrong')cls+=' incorrect'}return`<button class="${cls}" onclick="submitChoice(${i})" ${status?'disabled':''}><span class="choice-number">${i+1}</span>${c}</button>`}).join('')}</div>`}
function renderInput(p,status){return`<div class="answer-input-group"><input type="text" class="answer-input" id="ansIn" placeholder="ì •ë‹µ ì…ë ¥" ${status?'disabled':''} value="${status?p.ans:''}" onkeypress="if(event.key==='Enter')submitAns()"><button class="submit-btn" onclick="submitAns()" ${status?'disabled':''}>ì œì¶œ</button></div>`}

function submitChoice(i){const f=getFiltered();const p=f[state.probIdx];const ri=state.problems.indexOf(p);record(ri,i===p.ans);renderProblem()}
function submitAns(){const inp=document.getElementById('ansIn');if(!inp||!inp.value.trim())return;const f=getFiltered();const p=f[state.probIdx];const ri=state.problems.indexOf(p);const ua=inp.value.trim().replace(/\s/g,'');const ca=p.ans.replace(/\s/g,'');record(ri,ua===ca);renderProblem()}

function record(idx,correct){if(!state.progress[state.unit.id])state.progress[state.unit.id]={};const was=state.progress[state.unit.id][idx];state.progress[state.unit.id][idx]=correct?'correct':'wrong';if(!was){state.stats.total++;if(correct){state.stats.correct++;state.stats.streak++;toast('ì •ë‹µì…ë‹ˆë‹¤! ğŸ‰','success')}else{state.stats.streak=0;toast('ì˜¤ë‹µì…ë‹ˆë‹¤','error')}}save();updateNav()}

function updateNav(){const nav=document.getElementById('quickNav');const f=getFiltered();nav.innerHTML=f.slice(0,30).map((p,i)=>{const ri=state.problems.indexOf(p);const pr=state.progress[state.unit.id]||{};const st=pr[ri];let c='quick-nav-btn';if(i===state.probIdx)c+=' current';else if(st==='correct')c+=' solved';else if(st==='wrong')c+=' wrong';return`<button class="${c}" onclick="goTo(${i})">${ri+1}</button>`}).join('')}
function updateProbNav(){const f=getFiltered();document.getElementById('problemIndicator').textContent=`${state.probIdx+1} / ${f.length}`;document.getElementById('prevBtn').disabled=state.probIdx===0;document.getElementById('nextBtn').disabled=state.probIdx>=f.length-1}

function goTo(i){state.probIdx=i;renderProblem();updateNav()}
function prev(){if(state.probIdx>0){state.probIdx--;renderProblem();updateNav()}}
function next(){const f=getFiltered();if(state.probIdx<f.length-1){state.probIdx++;renderProblem();updateNav()}}
function setFilter(f){state.filter=f;state.probIdx=0;document.querySelectorAll('.filter-btn').forEach(b=>b.classList.toggle('active',b.dataset.filter===f));renderProblem();updateNav()}

function toast(msg,type=''){const t=document.getElementById('toast');t.textContent=msg;t.className='toast '+type+' show';setTimeout(()=>t.classList.remove('show'),2000)}

document.addEventListener('DOMContentLoaded',()=>{load();renderUnits();
document.querySelectorAll('.grade-tab').forEach(t=>t.addEventListener('click',()=>{state.grade=+t.dataset.grade;document.querySelectorAll('.grade-tab').forEach(x=>x.classList.remove('active'));t.classList.add('active');state.semester=1;document.querySelectorAll('.semester-btn').forEach(b=>b.classList.toggle('active',b.dataset.semester==='1'));renderUnits()}));
document.querySelectorAll('.semester-btn').forEach(b=>b.addEventListener('click',()=>{state.semester=+b.dataset.semester;document.querySelectorAll('.semester-btn').forEach(x=>x.classList.remove('active'));b.classList.add('active');renderUnits()}));
document.querySelectorAll('.modal-tab').forEach(t=>t.addEventListener('click',()=>{const n=t.dataset.tab;document.querySelectorAll('.modal-tab').forEach(x=>x.classList.remove('active'));t.classList.add('active');document.getElementById('conceptSection').classList.toggle('active',n==='concept');document.getElementById('problemsSection').classList.toggle('active',n==='problems')}));
document.querySelectorAll('.filter-btn').forEach(b=>b.addEventListener('click',()=>setFilter(b.dataset.filter)));
document.getElementById('modalClose').addEventListener('click',closeModal);
document.getElementById('modalOverlay').addEventListener('click',closeModal);
document.getElementById('prevBtn').addEventListener('click',prev);
document.getElementById('nextBtn').addEventListener('click',next);
document.addEventListener('keydown',e=>{if(!document.getElementById('modal').classList.contains('active'))return;if(document.activeElement.tagName==='INPUT')return;if(e.key==='ArrowLeft')prev();else if(e.key==='ArrowRight')next();else if(e.key==='Escape')closeModal()})});
</script>
</body>
</html>
